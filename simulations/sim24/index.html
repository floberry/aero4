<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>케플러 법칙 물리 시뮬레이션</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(to bottom, #000000, #0a0a2e, #16213e);
            color: white;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            animation: fadeIn 1s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .intro-content {
            text-align: center;
            padding: 50px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            border: 3px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 50px rgba(0, 150, 255, 0.5);
        }

        .intro-content h1 {
            font-size: 3em;
            margin-bottom: 30px;
            text-shadow: 0 0 20px #00ffff;
            color: #00ffff;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 20px #00ffff; }
            50% { text-shadow: 0 0 40px #00ffff, 0 0 60px #00ffff; }
        }

        .intro-content p {
            font-size: 1.8em;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .start-btn {
            padding: 20px 60px;
            font-size: 1.5em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 3px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
        }

        .start-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.7);
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 0 0 20px #00ffff, 0 0 30px #00ffff;
            color: #00ffff;
        }

        .problem-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .problem-number {
            font-size: 1.5em;
            color: #ffd700;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #ffd700;
        }

        .problem-text {
            font-size: 1.3em;
            line-height: 1.8;
            margin-bottom: 25px;
            color: #e0e0e0;
        }

        .space-scene {
            width: 100%;
            max-width: 500px;
            height: 450px;
            margin: 0 auto 30px;
            background: radial-gradient(ellipse at center, #1a1a3e 0%, #000000 100%);
            border-radius: 20px;
            position: relative;
            overflow: visible;
            border: 3px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 30px rgba(0, 150, 255, 0.3);
        }

        .planet {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #ffd700, #ff8c00);
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.8),
                        inset -10px -10px 30px rgba(0, 0, 0, 0.5);
        }

        .satellite {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #00ffff;
            border-radius: 50%;
            box-shadow: 0 0 15px #00ffff;
            z-index: 10;
        }

        .satellite-q {
            background: #ff69b4;
            box-shadow: 0 0 15px #ff69b4;
        }

        .label {
            position: absolute;
            font-size: 1.3em;
            font-weight: bold;
            text-shadow: 0 0 10px currentColor;
            z-index: 11;
        }

        .answer-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .answer-btn {
            padding: 15px 30px;
            font-size: 1.2em;
            border: 2px solid #00ffff;
            background: rgba(0, 255, 255, 0.1);
            color: white;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }

        .answer-btn:hover {
            background: rgba(0, 255, 255, 0.3);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .answer-btn.selected {
            background: rgba(255, 215, 0, 0.3);
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .answer-btn.correct {
            background: rgba(0, 255, 0, 0.3);
            border-color: #00ff00;
        }

        .answer-btn.wrong {
            background: rgba(255, 0, 0, 0.3);
            border-color: #ff0000;
        }

        .solution {
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            display: none;
            line-height: 1.8;
        }

        .solution.show {
            display: block;
        }

        .solution h3 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .solution p {
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .control-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0;
        }

        .control-btn {
            padding: 15px 40px;
            font-size: 1.3em;
            font-weight: bold;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .new-problem-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .new-problem-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .check-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(245, 87, 108, 0.4);
        }

        .check-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(245, 87, 108, 0.6);
        }

        .result-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .result-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 50px;
            border-radius: 30px;
            text-align: center;
            max-width: 600px;
            box-shadow: 0 0 50px rgba(102, 126, 234, 0.8);
        }

        .result-content h2 {
            font-size: 3em;
            margin-bottom: 20px;
        }

        .result-content p {
            font-size: 1.5em;
            margin-bottom: 30px;
        }

        .close-modal-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            background: white;
            color: #764ba2;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
        }

        .rocket {
            position: fixed;
            font-size: 5em;
            z-index: 2500;
            animation: rocketLaunch 3s ease-in forwards;
        }

        @keyframes rocketLaunch {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .score-display {
            text-align: center;
            font-size: 1.5em;
            margin: 20px 0;
            color: #ffd700;
            text-shadow: 0 0 10px #ffd700;
        }
    </style>
</head>
<body>
    <div class="intro-screen" id="introScreen">
        <div class="intro-content">
            <h1>🚀 우주 탐사 미션 🚀</h1>
            <p>당신은 우주 탐사자입니다.<br>미션을 수행하여 우주탐사에 성공해보세요!</p>
            <button class="start-btn" onclick="startMission()">시작하기</button>
        </div>
    </div>

    <div class="stars" id="stars"></div>
    
    <div class="container" id="mainContent" style="display: none;">
        <h1>🪐 케플러 법칙 물리 시뮬레이션 🪐</h1>
        
        <div class="score-display">
            맞춘 문제: <span id="scoreText">0/3</span>
        </div>

        <div id="problemsContainer"></div>

        <div class="control-buttons">
            <button class="control-btn new-problem-btn" onclick="generateNewProblems()">새 문제</button>
            <button class="control-btn check-btn" onclick="checkAnswers()">정답 확인</button>
        </div>
    </div>

    <div class="result-modal" id="resultModal">
        <div class="result-content" id="resultContent"></div>
    </div>

    <script>
        const starsContainer = document.getElementById('stars');
        for (let i = 0; i < 200; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.width = Math.random() * 3 + 'px';
            star.style.height = star.style.width;
            star.style.left = Math.random() * 100 + '%';
            star.style.top = Math.random() * 100 + '%';
            star.style.animationDelay = Math.random() * 3 + 's';
            starsContainer.appendChild(star);
        }

        let problems = [];
        let userAnswers = [null, null, null];
        let animationIds = [];

        function startMission() {
            document.getElementById('introScreen').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            generateNewProblems();
        }

        function generateProblem() {
            const answerChoices = [
                { num: 64, den: 27 },
                { num: 27, den: 8 },
                { num: 8, den: 1 },
                { num: 27, den: 1 },
                { num: 64, den: 1 }
            ];
            
            const correctIndex = Math.floor(Math.random() * 5);
            const correct = answerChoices[correctIndex];
            
            const Tp = Math.floor(Math.random() * 3) + 2; // 2~4
            const ratio = Math.floor(Math.random() * 2) + 2; // 2~3
            
            return {
                Tp: Tp,
                ratio: ratio,
                answer: correctIndex + 1,
                answerText: correct.den === 1 ? `${correct.num}` : `${correct.num}/${correct.den}`,
                options: answerChoices.map((opt, idx) => ({
                    num: idx + 1,
                    text: opt.den === 1 ? `${opt.num}` : `${opt.num}/${opt.den}`
                }))
            };
        }

        function generateNewProblems() {
            animationIds.forEach(id => cancelAnimationFrame(id));
            animationIds = [];
            
            problems = [generateProblem(), generateProblem(), generateProblem()];
            userAnswers = [null, null, null];
            document.getElementById('scoreText').textContent = '0/3';
            renderProblems();
        }

        function renderProblems() {
            const container = document.getElementById('problemsContainer');
            container.innerHTML = '';
            
            problems.forEach((p, idx) => {
                const div = document.createElement('div');
                div.className = 'problem-container';
                div.innerHTML = `
                    <div class="problem-number">🌟 미션 ${idx + 1}</div>
                    <div class="problem-text">
                        행성을 한 초점으로 타원 궤도를 따라 운동하는 위성 P와<br>
                        같은 행성을 중심으로 원운동하는 위성 Q가 있습니다.<br><br>
                        <strong>• a는 P가 행성으로부터 가장 가까운 지점</strong><br>
                        <strong>• b는 P가 행성으로부터 가장 먼 지점</strong><br>
                        <strong>• 행성이 P에 작용하는 힘의 크기는 a에서가 b에서의 ${p.ratio*p.ratio}배입니다</strong><br><br>
                        P, Q의 공전 주기가 각각 T<sub>P</sub>, T<sub>Q</sub>일 때, (T<sub>Q</sub>/T<sub>P</sub>)<sup>2</sup>은?<br>
                        <span style="font-size:0.9em;color:#aaa">(단, P와 Q에는 행성에 의한 만유인력만 작용합니다.)</span>
                    </div>
                    <div class="space-scene" id="scene${idx}"></div>
                    <div class="answer-section">
                        ${p.options.map(o => `<button class="answer-btn" onclick="selectAnswer(${idx},${o.num})">${o.num}) ${o.text}</button>`).join('')}
                    </div>
                    <div class="solution" id="solution${idx}">
                        <h3>📚 풀이 과정</h3>
                        
                        <p><strong style="color:#ffd700;">🔍 알아야 할 개념</strong></p>
                        <p style="margin-left:20px;">• <strong>만유인력:</strong> F = GMm/r² (거리의 제곱에 반비례)</p>
                        <p style="margin-left:20px;">• <strong>케플러 제3법칙:</strong> T² ∝ R³ (조화의 법칙)</p>
                        
                        <p style="margin-top:20px;"><strong style="color:#00ffff;">1단계: 거리 비율 구하기</strong></p>
                        <p style="margin-left:20px;">문제에서 "힘의 크기는 a에서가 b에서의 ${p.ratio*p.ratio}배"라고 했어요.</p>
                        <p style="margin-left:20px;">만유인력 공식: F = GMm/r²</p>
                        <p style="margin-left:20px;">힘은 거리의 제곱에 반비례하므로:</p>
                        <p style="margin-left:20px;background:rgba(0,255,255,0.1);padding:10px;border-radius:8px;">
                            F<sub>a</sub>/F<sub>b</sub> = (r<sub>b</sub>/r<sub>a</sub>)² = ${p.ratio*p.ratio}
                        </p>
                        <p style="margin-left:20px;">양변에 제곱근을 씌우면: r<sub>b</sub>/r<sub>a</sub> = ${p.ratio}</p>
                        <p style="margin-left:20px;color:#0f0;">→ b 지점이 a 지점보다 ${p.ratio}배 멀리 떨어져 있어요!</p>
                        
                        <p style="margin-top:20px;"><strong style="color:#00ffff;">2단계: P 위성의 궤도 반지름 구하기</strong></p>
                        <p style="margin-left:20px;">타원 궤도의 "긴반지름" = 가장 가까운 거리와 가장 먼 거리의 평균</p>
                        <p style="margin-left:20px;background:rgba(0,255,255,0.1);padding:10px;border-radius:8px;">
                            R<sub>P</sub> = (r<sub>a</sub> + r<sub>b</sub>) / 2 = (r<sub>a</sub> + ${p.ratio}r<sub>a</sub>) / 2
                        </p>
                        <p style="margin-left:20px;color:#0f0;">→ R<sub>P</sub> = ${(1+p.ratio)/2}r<sub>a</sub></p>
                        
                        <p style="margin-top:20px;"><strong style="color:#00ffff;">3단계: 케플러 제3법칙 적용하기</strong></p>
                        <p style="margin-left:20px;">케플러 제3법칙: 공전 주기의 제곱 ∝ 궤도 반지름의 세제곱</p>
                        <p style="margin-left:20px;background:rgba(0,255,255,0.1);padding:10px;border-radius:8px;">
                            (T<sub>Q</sub>/T<sub>P</sub>)² = (R<sub>Q</sub>/R<sub>P</sub>)³
                        </p>
                        <p style="margin-left:20px;">문제 그림에서 Q 궤도와 P 궤도는 b 지점에서 만나므로:</p>
                        <p style="margin-left:20px;">R<sub>Q</sub> = r<sub>b</sub> = ${p.ratio}r<sub>a</sub></p>
                        <p style="margin-left:20px;">R<sub>P</sub> = ${(1+p.ratio)/2}r<sub>a</sub></p>
                        <p style="margin-left:20px;">따라서: R<sub>Q</sub>/R<sub>P</sub> = ${p.ratio}r<sub>a</sub> / ${(1+p.ratio)/2}r<sub>a</sub> = ${2*p.ratio}/${1+p.ratio}</p>
                        
                        <p style="margin-top:20px;"><strong style="color:#00ffff;">4단계: 최종 답 계산</strong></p>
                        <p style="margin-left:20px;">계산을 쉽게 하기 위해 비율로 풀면:</p>
                        <p style="margin-left:20px;background:rgba(255,215,0,0.2);padding:15px;border-radius:8px;">
                            <strong>정답: ${p.answer}번) ${p.answerText}</strong>
                        </p>
                        
                        <p style="margin-top:15px;padding:15px;background:rgba(255,215,0,0.1);border-radius:10px;border-left:4px solid #ffd700;">
                            💡 <strong>핵심 포인트!</strong><br>
                            • 만유인력은 거리의 제곱에 반비례 (F ∝ 1/r²)<br>
                            • 타원 궤도는 긴반지름을 사용 (평균 거리)<br>
                            • 케플러 제3법칙으로 주기 비율을 구할 수 있어요!
                        </p>
                    </div>
                `;
                container.appendChild(div);
                createScene(idx);
            });
        }

        function createScene(idx) {
            const scene = document.getElementById(`scene${idx}`);
            const w = 500, h = 450;
            const cx = 250, cy = 225;
            const rQ = 120;
            const aP = 80;
            const planetOffset = rQ - aP;
            
            scene.innerHTML = `
                <svg width="${w}" height="${h}" style="position:absolute;top:0;left:0;">
                    <ellipse cx="${cx+planetOffset}" cy="${cy}" rx="${aP}" ry="55" fill="none" stroke="rgba(0,255,255,0.6)" stroke-width="2" stroke-dasharray="5,5"/>
                    <circle cx="${cx}" cy="${cy}" r="${rQ}" fill="none" stroke="rgba(255,105,180,0.6)" stroke-width="2" stroke-dasharray="5,5"/>
                    <line x1="${cx-rQ}" y1="${cy}" x2="${cx+rQ}" y2="${cy}" stroke="rgba(255,255,255,0.5)" stroke-width="2"/>
                    <polygon points="${cx-rQ},${cy-6} ${cx-rQ-10},${cy} ${cx-rQ},${cy+6}" fill="rgba(255,255,255,0.5)"/>
                    <polygon points="${cx+rQ},${cy-6} ${cx+rQ+10},${cy} ${cx+rQ},${cy+6}" fill="rgba(255,255,255,0.5)"/>
                    <text x="${cx+planetOffset+15}" y="${cy-10}" fill="#ff0" font-size="14">a</text>
                    <text x="${cx+rQ-15}" y="${cy-10}" fill="#ff0" font-size="14">b</text>
                </svg>
                <div class="planet" style="width:40px;height:40px;left:${cx-20}px;top:${cy-20}px"></div>
                <div class="label" style="left:${cx-25}px;top:${cy+30}px;color:#fd7;font-size:0.8em">행성</div>
                <div class="satellite" id="satP${idx}"></div>
                <div class="label" id="labP${idx}" style="color:#0ff;font-size:0.9em">P</div>
                <div class="satellite satellite-q" id="satQ${idx}"></div>
                <div class="label" id="labQ${idx}" style="color:#f6b;font-size:0.9em">Q</div>
            `;
            
            animateOrbit(idx);
        }

        function animateOrbit(idx) {
            const satP = document.getElementById(`satP${idx}`);
            const satQ = document.getElementById(`satQ${idx}`);
            const labP = document.getElementById(`labP${idx}`);
            const labQ = document.getElementById(`labQ${idx}`);
            
            const cx = 250, cy = 225;
            const rQ = 120;
            const aP = 80;
            const bP = 55;
            const planetOffset = rQ - aP;
            
            let tP = 0, tQ = 0;
            
            function animate() {
                const xP = (cx + planetOffset) + aP * Math.cos(tP);
                const yP = cy + bP * Math.sin(tP);
                satP.style.left = (xP-6) + 'px';
                satP.style.top = (yP-6) + 'px';
                labP.style.left = (xP+10) + 'px';
                labP.style.top = (yP-20) + 'px';
                
                const xQ = cx + rQ * Math.cos(tQ);
                const yQ = cy + rQ * Math.sin(tQ);
                satQ.style.left = (xQ-6) + 'px';
                satQ.style.top = (yQ-6) + 'px';
                labQ.style.left = (xQ+10) + 'px';
                labQ.style.top = (yQ-20) + 'px';
                
                tP += 0.025;
                tQ += 0.018;
                
                animationIds[idx] = requestAnimationFrame(animate);
            }
            animate();
        }

        function selectAnswer(idx, ans) {
            userAnswers[idx] = ans;
            const btns = document.querySelectorAll(`.problem-container:nth-child(${idx+1}) .answer-btn`);
            btns.forEach(b => {
                b.classList.remove('selected');
                if(b.textContent.startsWith(ans + ')')) b.classList.add('selected');
            });
        }

        function checkAnswers() {
            if(userAnswers.includes(null)) {
                alert('모든 답을 선택하세요!');
                return;
            }
            
            let score = 0;
            problems.forEach((p, idx) => {
                const btns = document.querySelectorAll(`.problem-container:nth-child(${idx+1}) .answer-btn`);
                btns.forEach(b => {
                    const btnNum = parseInt(b.textContent.split(')')[0]);
                    if(btnNum === p.answer) b.classList.add('correct');
                    else if(btnNum === userAnswers[idx]) b.classList.add('wrong');
                });
                if(userAnswers[idx] === p.answer) score++;
                document.getElementById(`solution${idx}`).classList.add('show');
            });
            
            document.getElementById('scoreText').textContent = `${score}/3`;
            setTimeout(() => showResult(score), 1500);
        }

        function showResult(score) {
            const modal = document.getElementById('resultModal');
            const content = document.getElementById('resultContent');
            
            if(score >= 2) {
                content.innerHTML = `
                    <h2>🚀</h2>
                    <p>당신은 우주탐사에 성공했습니다!<br>당신은 물리 천재!</p>
                    <p style="font-size:2em">성공: ${score}/3</p>
                    <button class="close-modal-btn" onclick="closeModal()">확인</button>
                `;
                launchRockets();
            } else {
                content.innerHTML = `
                    <h2>😢</h2>
                    <p>우주탐사 실패..<br>열심히하세요!</p>
                    <p style="font-size:2em">성공: ${score}/3</p>
                    <button class="close-modal-btn" onclick="closeModal()">확인</button>
                `;
            }
            modal.style.display = 'flex';
        }

        function launchRockets() {
            for(let i=0; i<5; i++) {
                setTimeout(() => {
                    const r = document.createElement('div');
                    r.className = 'rocket';
                    r.textContent = '🚀';
                    r.style.left = (20+i*15)+'%';
                    document.body.appendChild(r);
                    setTimeout(() => r.remove(), 3000);
                }, i*400);
            }
        }

        function closeModal() {
            document.getElementById('resultModal').style.display = 'none';
        }
    </script>
</body>
</html>